this is the second branch code and try to fix bug for main branch